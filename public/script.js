const translations = {
  en: {
    "page-title": "Crop Advisory â€“ Weather Dashboard",
    language: "Language",
    "weather-info": "Weather Information",
    "enter-city": "Enter city name",
    search: "Search",
    "locate-me": "Locate Me",
    "loading-weather": "Loading weather data...",
    temperature: "Temperature:",
    humidity: "Humidity:",
    windSpeed: "Wind Speed:",
    condition: "Condition:",
    "crop-details-title": "ðŸŒ¾ Crop Details",
    "crop-details-description": "Enter details about your crop to get personalized advice.",
    "crop-type-label": "Crop Type:",
    "crop-type-placeholder": "e.g., Wheat, Rice, Corn",
    "growth-stage-label": "Growth Stage:",
    "growth-stage-placeholder": "e.g., Germination, Flowering, Harvesting",
    "soil-type-label": "Soil Type:",
    "soil-type-placeholder": "e.g., Loamy, Clay, Sandy",
    "observations-label": "Recent Observations:",
    "observations-placeholder": "e.g., Yellowing leaves, new shoots, pest signs",
    "update-crop-details": "Update Crop Details & Get Advice",
    "crop-details-updated": "Crop details updated! Getting personalized advice...",
    "crop-advice": "ðŸŒ± Crop Advice",
    "pest-alerts": "ðŸ› Pest Alerts",
    "watering-suggestion": "ðŸ’§ Watering Suggestion",
    "image-analysis-title": "ðŸ“¸ Crop Image Analysis",
    "image-analysis-description": "Upload an image of your crop for AI-powered insights.",
    "upload-image-button": "Choose Image",
    "no-file-chosen": "No file chosen",
    "analyze-image-button": "Analyze Image",
    "image-upload-success": "Image uploaded successfully. Analyzing...",
    "image-analysis-failed": "Image analysis failed. Please try again.",
    "analysis-results-heading": "Analysis Results:",
    "detected-crop-type": "Detected Crop Type:",
    "health-status": "Health Status:",
    "potential-issues": "Potential Issues:",
  },
  hi: {
    "page-title": "à¤«à¤¸à¤² à¤¸à¤²à¤¾à¤¹ â€“ à¤®à¥Œà¤¸à¤® à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡",
    language: "à¤­à¤¾à¤·à¤¾",
    "weather-info": "à¤®à¥Œà¤¸à¤® à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
    "enter-city": "à¤¶à¤¹à¤° à¤•à¤¾ à¤¨à¤¾à¤® à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚",
    search: "à¤–à¥‹à¤œà¥‡à¤‚",
    "locate-me": "à¤®à¥à¤à¥‡ à¤¢à¥‚à¤‚à¤¢à¥‹",
    "loading-weather": "à¤®à¥Œà¤¸à¤® à¤¡à¥‡à¤Ÿà¤¾ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
    temperature: "à¤¤à¤¾à¤ªà¤®à¤¾à¤¨:",
    humidity: "à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾:",
    windSpeed: "à¤¹à¤µà¤¾ à¤•à¥€ à¤—à¤¤à¤¿:",
    condition: "à¤¸à¥à¤¥à¤¿à¤¤à¤¿:",
    "crop-details-title": "ðŸŒ¾ à¤«à¤¸à¤² à¤µà¤¿à¤µà¤°à¤£",
    "crop-details-description": "à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤¸à¤²à¤¾à¤¹ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤…à¤ªà¤¨à¥€ à¤«à¤¸à¤² à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤µà¤¿à¤µà¤°à¤£ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚à¥¤",
    "crop-type-label": "à¤«à¤¸à¤² à¤•à¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "crop-type-placeholder": "à¤‰à¤¦à¤¾à¤¹à¤°à¤£: à¤—à¥‡à¤¹à¥‚à¤‚, à¤šà¤¾à¤µà¤², à¤®à¤•à¥à¤•à¤¾",
    "growth-stage-label": "à¤µà¤¿à¤•à¤¾à¤¸ à¤šà¤°à¤£:",
    "growth-stage-placeholder": "à¤‰à¤¦à¤¾à¤¹à¤°à¤£: à¤…à¤‚à¤•à¥à¤°à¤£, à¤«à¥‚à¤² à¤†à¤¨à¤¾, à¤•à¤Ÿà¤¾à¤ˆ",
    "soil-type-label": "à¤®à¤¿à¤Ÿà¥à¤Ÿà¥€ à¤•à¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "soil-type-placeholder": "à¤‰à¤¦à¤¾à¤¹à¤°à¤£: à¤¦à¥‹à¤®à¤Ÿ, à¤šà¤¿à¤•à¤¨à¥€, à¤°à¥‡à¤¤à¥€à¤²à¥€",
    "observations-label": "à¤¹à¤¾à¤² à¤•à¥€ à¤Ÿà¤¿à¤ªà¥à¤ªà¤£à¤¿à¤¯à¤¾à¤:",
    "observations-placeholder": "à¤‰à¤¦à¤¾à¤¹à¤°à¤£: à¤ªà¤¤à¥à¤¤à¤¿à¤¯à¤¾à¤‚ à¤ªà¥€à¤²à¥€ à¤ªà¤¡à¤¼à¤¨à¤¾, à¤¨à¤ˆ à¤•à¥‹à¤‚à¤ªà¤²à¥‡à¤‚, à¤•à¥€à¤Ÿ à¤•à¥‡ à¤²à¤•à¥à¤·à¤£",
    "update-crop-details": "à¤«à¤¸à¤² à¤µà¤¿à¤µà¤°à¤£ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤¸à¤²à¤¾à¤¹ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚",
    "crop-details-updated": "à¤«à¤¸à¤² à¤µà¤¿à¤µà¤°à¤£ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾! à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤¸à¤²à¤¾à¤¹ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆ...",
    "crop-advice": "ðŸŒ± à¤«à¤¸à¤² à¤¸à¤²à¤¾à¤¹",
    "pest-alerts": "ðŸ› à¤•à¥€à¤Ÿ à¤…à¤²à¤°à¥à¤Ÿ",
    "watering-suggestion": "ðŸ’§ à¤ªà¤¾à¤¨à¥€ à¤¦à¥‡à¤¨à¥‡ à¤•à¤¾ à¤¸à¥à¤à¤¾à¤µ",
    "image-analysis-title": "ðŸ“¸ à¤«à¤¸à¤² à¤›à¤µà¤¿ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£",
    "image-analysis-description": "à¤à¤†à¤ˆ-à¤¸à¤‚à¤šà¤¾à¤²à¤¿à¤¤ à¤…à¤‚à¤¤à¤°à¥à¤¦à¥ƒà¤·à¥à¤Ÿà¤¿ à¤•à¥‡ à¤²à¤¿à¤ à¤…à¤ªà¤¨à¥€ à¤«à¤¸à¤² à¤•à¥€ à¤à¤• à¤›à¤µà¤¿ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚à¥¤",
    "upload-image-button": "à¤›à¤µà¤¿ à¤šà¥à¤¨à¥‡à¤‚",
    "no-file-chosen": "à¤•à¥‹à¤ˆ à¤«à¤¼à¤¾à¤‡à¤² à¤¨à¤¹à¥€à¤‚ à¤šà¥à¤¨à¥€ à¤—à¤ˆ",
    "analyze-image-button": "à¤›à¤µà¤¿ à¤•à¤¾ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤•à¤°à¥‡à¤‚",
    "image-upload-success": "à¤›à¤µà¤¿ à¤¸à¤«à¤²à¤¤à¤¾à¤ªà¥‚à¤°à¥à¤µà¤• à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¥€ à¤—à¤ˆà¥¤ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
    "image-analysis-failed": "à¤›à¤µà¤¿ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤µà¤¿à¤«à¤² à¤°à¤¹à¤¾à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤",
    "analysis-results-heading": "à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤ªà¤°à¤¿à¤£à¤¾à¤®:",
    "detected-crop-type": "à¤ªà¤¹à¤šà¤¾à¤¨à¤¾ à¤—à¤¯à¤¾ à¤«à¤¸à¤² à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "health-status": "à¤¸à¥à¤µà¤¾à¤¸à¥à¤¥à¥à¤¯ à¤¸à¥à¤¥à¤¿à¤¤à¤¿:",
    "potential-issues": "à¤¸à¤‚à¤­à¤¾à¤µà¤¿à¤¤ à¤®à¥à¤¦à¥à¤¦à¥‡:",
  },
  bn: {
    "page-title": "à¦¶à¦¸à§à¦¯ à¦ªà¦°à¦¾à¦®à¦°à§à¦¶ â€“ à¦†à¦¬à¦¹à¦¾à¦“à¦¯à¦¼à¦¾ à¦¡à§à¦¯à¦¾à¦¶à¦¬à§‹à¦°à§à¦¡",
    language: "à¦­à¦¾à¦·à¦¾",
    "weather-info": "à¦†à¦¬à¦¹à¦¾à¦“à¦¯à¦¼à¦¾à¦° à¦¤à¦¥à§à¦¯",
    "enter-city": "à¦¶à¦¹à¦°à§‡à¦° à¦¨à¦¾à¦® à¦²à¦¿à¦–à§à¦¨",
    search: "à¦…à¦¨à§à¦¸à¦¨à§à¦§à¦¾à¦¨",
    "locate-me": "à¦†à¦®à¦¾à¦•à§‡ à¦–à§à¦à¦œà§à¦¨",
    "loading-weather": "à¦†à¦¬à¦¹à¦¾à¦“à¦¯à¦¼à¦¾à¦° à¦¡à§‡à¦Ÿà¦¾ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...",
    temperature: "à¦¤à¦¾à¦ªà¦®à¦¾à¦¤à§à¦°à¦¾:",
    humidity: "à¦†à¦°à§à¦¦à§à¦°à¦¤à¦¾:",
    windSpeed: "à¦¬à¦¾à¦¤à¦¾à¦¸à§‡à¦° à¦—à¦¤à¦¿:",
    condition: "à¦…à¦¬à¦¸à§à¦¥à¦¾:",
    "crop-details-title": "ðŸŒ¾ à¦«à¦¸à¦²à§‡à¦° à¦¬à¦¿à¦¬à¦°à¦£",
    "crop-details-description": "à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦ªà¦°à¦¾à¦®à¦°à§à¦¶ à¦ªà§‡à¦¤à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦«à¦¸à¦² à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡ à¦¬à¦¿à¦¬à¦°à¦£ à¦²à¦¿à¦–à§à¦¨à¥¤",
    "crop-type-label": "à¦«à¦¸à¦²à§‡à¦° à¦ªà§à¦°à¦•à¦¾à¦°:",
    "crop-type-placeholder": "à¦¯à§‡à¦®à¦¨: à¦—à¦®, à¦§à¦¾à¦¨, à¦­à§à¦Ÿà§à¦Ÿà¦¾",
    "growth-stage-label": "à¦¬à§ƒà¦¦à§à¦§à¦¿à¦° à¦ªà¦°à§à¦¯à¦¾à¦¯à¦¼:",
    "growth-stage-placeholder": "à¦¯à§‡à¦®à¦¨: à¦…à¦™à§à¦•à§à¦°à§‹à¦¦à¦—à¦®, à¦«à§à¦² à¦†à¦¸à¦¾, à¦«à¦¸à¦² à¦•à¦¾à¦Ÿà¦¾",
    "soil-type-label": "à¦®à¦¾à¦Ÿà¦¿à¦° à¦ªà§à¦°à¦•à¦¾à¦°:",
    "soil-type-placeholder": "à¦¯à§‡à¦®à¦¨: à¦¦à§‹à¦†à¦à¦¶, à¦à¦à¦Ÿà§‡à¦², à¦¬à§‡à¦²à§‡",
    "observations-label": "à¦¸à¦¾à¦®à§à¦ªà§à¦°à¦¤à¦¿à¦• à¦ªà¦°à§à¦¯à¦¬à§‡à¦•à§à¦·à¦£:",
    "observations-placeholder": "à¦¯à§‡à¦®à¦¨: à¦ªà¦¾à¦¤à¦¾ à¦¹à¦²à§à¦¦ à¦¹à¦“à¦¯à¦¼à¦¾, à¦¨à¦¤à§à¦¨ à¦…à¦™à§à¦•à§à¦°, à¦•à§€à¦Ÿà¦ªà¦¤à¦™à§à¦—à§‡à¦° à¦²à¦•à§à¦·à¦£",
    "update-crop-details": "à¦«à¦¸à¦²à§‡à¦° à¦¬à¦¿à¦¬à¦°à¦£ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦ªà¦°à¦¾à¦®à¦°à§à¦¶ à¦ªà¦¾à¦¨",
    "crop-details-updated": "à¦«à¦¸à¦²à§‡à¦° à¦¬à¦¿à¦¬à¦°à¦£ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡! à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦ªà¦°à¦¾à¦®à¦°à§à¦¶ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦šà§à¦›à§‡...",
    "crop-advice": "ðŸŒ± à¦«à¦¸à¦²à§‡à¦° à¦ªà¦°à¦¾à¦®à¦°à§à¦¶",
    "pest-alerts": "ðŸ› à¦•à§€à¦Ÿà¦ªà¦¤à¦™à§à¦—à§‡à¦° à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾",
    "watering-suggestion": "ðŸ’§ à¦œà¦² à¦¦à§‡à¦“à¦¯à¦¼à¦¾à¦° à¦ªà¦°à¦¾à¦®à¦°à§à¦¶",
    "image-analysis-title": "ðŸ“¸ à¦«à¦¸à¦²à§‡à¦° à¦›à¦¬à¦¿ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£",
    "image-analysis-description": "à¦à¦†à¦‡-à¦šà¦¾à¦²à¦¿à¦¤ à¦…à¦¨à§à¦¤à¦°à§à¦¦à§ƒà¦·à§à¦Ÿà¦¿à¦° à¦œà¦¨à§à¦¯ à¦†à¦ªà¦¨à¦¾à¦° à¦«à¦¸à¦²à§‡à¦° à¦à¦•à¦Ÿà¦¿ à¦›à¦¬à¦¿ à¦†à¦ªà¦²à§‹à¦¡ à¦•à¦°à§à¦¨à¥¤",
    "upload-image-button": "à¦›à¦¬à¦¿ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨",
    "no-file-chosen": "à¦•à§‹à¦¨à§‹ à¦«à¦¾à¦‡à¦² à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à¦¨à¦¿",
    "analyze-image-button": "à¦›à¦¬à¦¿ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£ à¦•à¦°à§à¦¨",
    "image-upload-success": "à¦›à¦¬à¦¿ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦†à¦ªà¦²à§‹à¦¡ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£ à¦šà¦²à¦›à§‡...",
    "image-analysis-failed": "à¦›à¦¬à¦¿ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨à¥¤",
    "analysis-results-heading": "à¦¬à¦¿à¦¶à¤²à¥‡à¤·à¤£ à¦«à¦²à¦¾à¦«à¦²:",
    "detected-crop-type": "à¦¶à¦¨à¦¾à¦•à§à¦¤à¦•à§ƒà¦¤ à¦«à¦¸à¦²à§‡à¦° à¦ªà§à¦°à¦•à¦¾à¦°:",
    "health-status": "à¦¸à§à¦¬à¦¾à¦¸à§à¦¥à§à¦¯ à¦…à¦¬à¦¸à§à¦¥à¦¾:",
    "potential-issues": "à¦¸à¦®à§à¦­à¦¾à¦¬à§à¦¯ à¦¸à¦®à¦¸à§à¦¯à¦¾:",
  },
  ta: {
    "page-title": "à®ªà®¯à®¿à®°à¯ à®†à®²à¯‹à®šà®©à¯ˆ â€“ à®µà®¾à®©à®¿à®²à¯ˆ à®Ÿà®¾à®·à¯à®ªà¯‹à®°à¯à®Ÿà¯",
    language: "à®®à¯Šà®´à®¿",
    "weather-info": "à®µà®¾à®©à®¿à®²à¯ˆ à®¤à®•à®µà®²à¯",
    "enter-city": "à®¨à®•à®°à®¤à¯à®¤à®¿à®©à¯ à®ªà¯†à®¯à®°à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯",
    search: "à®¤à¯‡à®Ÿà®²à¯",
    "locate-me": "à®Žà®©à¯à®©à¯ˆ à®•à®£à¯à®Ÿà¯à®ªà®¿à®Ÿà®¿",
    "loading-weather": "à®µà®¾à®©à®¿à®²à¯ˆ à®¤à®°à®µà¯ à®à®±à¯à®±à®ªà¯à®ªà®Ÿà¯à®•à®¿à®±à®¤à¯...",
    temperature: "à®µà¯†à®ªà¯à®ªà®¨à®¿à®²à¯ˆ:",
    humidity: "à®ˆà®°à®ªà¯à®ªà®¤à®®à¯:",
    windSpeed: "à®•à®¾à®±à¯à®±à®¿à®©à¯ à®µà¯‡à®•à®®à¯:",
    condition: "à®¨à®¿à®²à¯ˆ:",
    "crop-details-title": "ðŸŒ¾ à®ªà®¯à®¿à®°à¯ à®µà®¿à®µà®°à®™à¯à®•à®³à¯",
    "crop-details-description": "à®¤à®©à®¿à®ªà¯à®ªà®¯à®©à®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿ à®†à®²à¯‹à®šà®©à¯ˆà®¯à¯ˆà®ªà¯ à®ªà¯†à®± à®‰à®™à¯à®•à®³à¯ à®ªà®¯à®¿à®°à¯ à®µà®¿à®µà®°à®™à¯à®•à®³à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯.",
    "crop-type-label": "à®ªà®¯à®¿à®°à¯ à®µà®•à¯ˆ:",
    "crop-type-placeholder": "à®Ž.à®•à®¾., à®•à¯‹à®¤à¯à®®à¯ˆ, à®…à®°à®¿à®šà®¿, à®šà¯‹à®³à®®à¯",
    "growth-stage-label": "à®µà®³à®°à¯à®šà¯à®šà®¿ à®¨à®¿à®²à¯ˆ:",
    "growth-stage-placeholder": "à®Ž.à®•à®¾., à®®à¯à®³à¯ˆà®¤à¯à®¤à®²à¯, à®ªà¯‚à®¤à¯à®¤à®²à¯, à®…à®±à¯à®µà®Ÿà¯ˆ",
    "soil-type-label": "à®®à®£à¯ à®µà®•à¯ˆ:",
    "soil-type-placeholder": "à®Ž.à®•à®¾., à®•à®³à®¿à®®à®£à¯, à®•à®³à®¿à®®à®£à¯, à®®à®£à®²à¯",
    "observations-label": "à®šà®®à¯€à®ªà®¤à¯à®¤à®¿à®¯ à®…à®µà®¤à®¾à®©à®¿à®ªà¯à®ªà¯à®•à®³à¯:",
    "observations-placeholder": "à®Ž.à®•à®¾., à®‡à®²à¯ˆà®•à®³à¯ à®®à®žà¯à®šà®³à¯ à®¨à®¿à®±à®®à®¾à®¤à®²à¯, à®ªà¯à®¤à®¿à®¯ à®¤à®³à®¿à®°à¯à®•à®³à¯, à®ªà¯‚à®šà¯à®šà®¿ à®…à®±à®¿à®•à¯à®±à®¿à®•à®³à¯",
    "update-crop-details": "à®ªà®¯à®¿à®°à¯ à®µà®¿à®µà®°à®™à¯à®•à®³à¯ˆ à®ªà¯à®¤à¯à®ªà¯à®ªà®¿à®¤à¯à®¤à¯ à®†à®²à¯‹à®šà®©à¯ˆ à®ªà¯†à®±à¯à®™à¯à®•à®³à¯",
    "crop-details-updated": "à®ªà®¯à®¿à®°à¯ à®µà®¿à®µà®°à®™à¯à®•à®³à¯ à®ªà¯à®¤à¯à®ªà¯à®ªà®¿à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®©! à®¤à®©à®¿à®ªà¯à®ªà®¯à®©à®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿ à®†à®²à¯‹à®šà®©à¯ˆ à®ªà¯†à®±à®ªà¯à®ªà®Ÿà¯à®•à®¿à®±à®¤à¯...",
    "crop-advice": "ðŸŒ± à®ªà®¯à®¿à®°à¯ à®†à®²à¯‹à®šà®©à¯ˆ",
    "pest-alerts": "ðŸ› à®ªà¯‚à®šà¯à®šà®¿ à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆà®•à®³à¯",
    "watering-suggestion": "ðŸ’§ à®¨à¯€à®°à¯à®ªà¯à®ªà®¾à®šà®© à®ªà®°à®¿à®¨à¯à®¤à¯à®°à¯ˆ",
    "image-analysis-title": "ðŸ“¸ à®ªà®¯à®¿à®°à¯ à®ªà®Ÿ à®ªà®•à¯à®ªà¯à®ªà®¾à®¯à¯à®µà¯",
    "image-analysis-description": "AI-à®‡à®¯à®™à¯à®•à¯à®®à¯ à®¨à¯à®£à¯à®£à®±à®¿à®µà¯à®•à®³à¯à®•à¯à®•à¯ à®‰à®™à¯à®•à®³à¯ à®ªà®¯à®¿à®°à®¿à®©à¯ à®ªà®Ÿà®¤à¯à®¤à¯ˆ à®ªà®¤à®¿à®µà¯‡à®±à¯à®±à®µà¯à®®à¯.",
    "upload-image-button": "à®ªà®Ÿà®¤à¯à®¤à¯ˆà®¤à¯ à®¤à¯‡à®°à¯à®µà¯à®šà¯†à®¯à¯",
    "no-file-chosen": "à®•à¯‹à®ªà¯à®ªà¯ à®Žà®¤à¯à®µà¯à®®à¯ à®¤à¯‡à®°à¯à®¨à¯à®¤à¯†à®Ÿà¯à®•à¯à®•à®ªà¯à®ªà®Ÿà®µà®¿à®²à¯à®²à¯ˆ",
    "analyze-image-button": "à®ªà®Ÿà®¤à¯à®¤à¯ˆ à®ªà®•à¯à®ªà¯à®ªà®¾à®¯à¯à®µà¯ à®šà¯†à®¯à¯",
    "image-upload-success": "à®ªà®Ÿà®®à¯ à®µà¯†à®±à¯à®±à®¿à®•à®°à®®à®¾à®• à®ªà®¤à®¿à®µà¯‡à®±à¯à®±à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯. à®ªà®•à¯à®ªà¯à®ªà®¾à®¯à¯à®µà¯ à®šà¯†à®¯à¯à®¯à®ªà¯à®ªà®Ÿà¯à®•à®¿à®±à®¤à¯...",
    "image-analysis-failed": "à®ªà®Ÿ à®ªà®•à¯à®ªà¯à®ªà®¾à®¯à¯à®µà¯ à®¤à¯‹à®²à¯à®µà®¿à®¯à®Ÿà¯ˆà®¨à¯à®¤à®¤à¯. à®®à¯€à®£à¯à®Ÿà¯à®®à¯ à®®à¯à®¯à®±à¯à®šà®¿à®•à¯à®•à®µà¯à®®à¯.",
    "analysis-results-heading": "à®ªà®•à¯à®ªà¯à®ªà®¾à®¯à¯à®µà¯ à®®à¯à®Ÿà®¿à®µà¯à®•à®³à¯:",
    "detected-crop-type": "à®•à®£à¯à®Ÿà®±à®¿à®¯à®ªà¯à®ªà®Ÿà¯à®Ÿ à®ªà®¯à®¿à®°à¯ à®µà®•à¯ˆ:",
    "health-status": "à®†à®°à¯‹à®•à¯à®•à®¿à®¯ à®¨à®¿à®²à¯ˆ:",
    "potential-issues": "à®šà®¾à®¤à¯à®¤à®¿à®¯à®®à®¾à®© à®šà®¿à®•à¯à®•à®²à¯à®•à®³à¯:",
  },
  te: {
    "page-title": "à°ªà°‚à°Ÿ à°¸à°²à°¹à°¾ â€“ à°µà°¾à°¤à°¾à°µà°°à°£ à°¡à°¾à°·à±â€Œà°¬à±‹à°°à±à°¡à±",
    language: "à°­à°¾à°·",
    "weather-info": "à°µà°¾à°¤à°¾à°µà°°à°£ à°¸à°®à°¾à°šà°¾à°°à°‚",
    "enter-city": "à°¨à°—à°°à°‚ à°ªà±‡à°°à± à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿",
    search: "à°¶à±‹à°§à°¨",
    "locate-me": "à°¨à°¨à±à°¨à± à°—à±à°°à±à°¤à°¿à°‚à°šà±",
    "loading-weather": "à°µà°¾à°¤à°¾à°µà°°à°£ à°¡à±‡à°Ÿà°¾ à°²à±‹à°¡à± à°…à°µà±à°¤à±‹à°‚à°¦à°¿...",
    temperature: "à°‰à°·à±à°£à±‹à°—à±à°°à°¤:",
    humidity: "à°¤à±‡à°®:",
    windSpeed: "à°—à°¾à°²à°¿ à°µà±‡à°—à°‚:",
    condition: "à°ªà°°à°¿à°¸à±à°¥à°¿à°¤à°¿:",
    "crop-details-title": "ðŸŒ¾ à°ªà°‚à°Ÿ à°µà°¿à°µà°°à°¾à°²à±",
    "crop-details-description": "à°µà±à°¯à°•à±à°¤à°¿à°—à°¤à±€à°•à°°à°¿à°‚à°šà°¿à°¨ à°¸à°²à°¹à°¾ à°ªà±Šà°‚à°¦à°¡à°¾à°¨à°¿à°•à°¿ à°®à±€ à°ªà°‚à°Ÿ à°µà°¿à°µà°°à°¾à°²à°¨à± à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿.",
    "crop-type-label": "à°ªà°‚à°Ÿ à°°à°•à°‚:",
    "crop-type-placeholder": "à°‰à°¦à°¾: à°—à±‹à°§à±à°®, à°µà°°à°¿, à°®à±Šà°•à±à°•à°œà±Šà°¨à±à°¨",
    "growth-stage-label": "à°µà±ƒà°¦à±à°§à°¿ à°¦à°¶:",
    "growth-stage-placeholder": "à°‰à°¦à°¾: à°®à±Šà°²à°•à±†à°¤à±à°¤à°¡à°‚, à°ªà±‚à°¤, à°•à±‹à°¤",
    "soil-type-label": "à°¨à±‡à°² à°°à°•à°‚:",
    "soil-type-placeholder": "à°‰à°¦à°¾: à°²à±‹à°®à±€, à°¬à°‚à°•à°®à°Ÿà±à°Ÿà°¿, à°‡à°¸à±à°•",
    "observations-label": "à°‡à°Ÿà±€à°µà°²à°¿ à°ªà°°à°¿à°¶à±€à°²à°¨à°²à±:",
    "observations-placeholder": "à°‰à°¦à°¾: à°†à°•à±à°²à± à°ªà°¸à±à°ªà± à°°à°‚à°—à±à°²à±‹à°•à°¿ à°®à°¾à°°à°¡à°‚, à°•à±Šà°¤à±à°¤ à°°à±†à°®à±à°®à°²à±, à°¤à±†à°—à±à°²à± à°¸à°‚à°•à±‡à°¤à°¾à°²à±",
    "update-crop-details": "à°ªà°‚à°Ÿ à°µà°¿à°µà°°à°¾à°²à°¨à± à°¨à°µà±€à°•à°°à°¿à°‚à°šà°‚à°¡à°¿ & à°¸à°²à°¹à°¾ à°ªà±Šà°‚à°¦à°‚à°¡à°¿",
    "crop-details-updated": "à°ªà°‚à°Ÿ à°µà°¿à°µà°°à°¾à°²à± à°¨à°µà±€à°•à°°à°¿à°‚à°šà°¬à°¡à±à°¡à°¾à°¯à°¿! à°µà±à°¯à°•à±à°¤à°¿à°—à°¤à±€à°•à°°à°¿à°‚à°šà°¿à°¨ à°¸à°²à°¹à°¾ à°ªà±Šà°‚à°¦à°¬à°¡à±à°¤à±‹à°‚à°¦à°¿...",
    "crop-advice": "ðŸŒ± à°ªà°‚à°Ÿ à°¸à°²à°¹à°¾",
    "pest-alerts": "ðŸ› à°¤à±†à°—à±à°²à± à°¹à±†à°šà±à°šà°°à°¿à°•à°²à±",
    "watering-suggestion": "ðŸ’§ à°¨à±€à°Ÿà°¿à°ªà°¾à°°à±à°¦à°² à°¸à±‚à°šà°¨",
    "image-analysis-title": "ðŸ“¸ à°ªà°‚à°Ÿ à°šà°¿à°¤à±à°°à°‚ à°µà°¿à°¶à±à°²à±‡à°·à°£",
    "image-analysis-description": "AI-à°¶à°•à±à°¤à°¿à°¤à±‹ à°•à±‚à°¡à°¿à°¨ à°…à°‚à°¤à°°à±à°¦à±ƒà°·à±à°Ÿà±à°² à°•à±‹à°¸à°‚ à°®à±€ à°ªà°‚à°Ÿ à°šà°¿à°¤à±à°°à°¾à°¨à±à°¨à°¿ à°…à°ªà±â€Œà°²à±‹à°¡à± à°šà±‡à°¯à°‚à°¡à°¿.",
    "upload-image-button": "à°šà°¿à°¤à±à°°à°¾à°¨à±à°¨à°¿ à°Žà°‚à°šà±à°•à±‹à°‚à°¡à°¿",
    "no-file-chosen": "à°«à±ˆà°²à± à°Žà°‚à°šà±à°•à±‹à°¬à°¡à°²à±‡à°¦à±",
    "analyze-image-button": "à°šà°¿à°¤à±à°°à°¾à°¨à±à°¨à°¿ à°µà°¿à°¶à±à°²à±‡à°·à°¿à°‚à°šà°‚à°¡à°¿",
    "image-upload-success": "à°šà°¿à°¤à±à°°à°‚ à°µà°¿à°œà°¯à°µà°‚à°¤à°‚à°—à°¾ à°…à°ªà±â€Œà°²à±‹à°¡à± à°šà±‡à°¯à°¬à°¡à°¿à°‚à°¦à°¿. à°µà°¿à°¶à±à°²à±‡à°·à°¿à°¸à±à°¤à±‹à°‚à°¦à°¿...",
    "image-analysis-failed": "à°šà°¿à°¤à±à°° à°µà°¿à°¶à±à°²à±‡à°·à°£ à°µà°¿à°«à°²à°®à±ˆà°‚à°¦à°¿. à°¦à°¯à°šà±‡à°¸à°¿ à°®à°³à±à°²à±€ à°ªà±à°°à°¯à°¤à±à°¨à°¿à°‚à°šà°‚à°¡à°¿.",
    "analysis-results-heading": "à°µà°¿à°¶à±à°²à±‡à°·à°£ à°«à°²à°¿à°¤à°¾à°²à±:",
    "detected-crop-type": "à°—à±à°°à±à°¤à°¿à°‚à°šà°¬à°¡à°¿à°¨ à°ªà°‚à°Ÿ à°°à°•à°‚:",
    "health-status": "à°†à°°à±‹à°—à±à°¯ à°¸à±à°¥à°¿à°¤à°¿:",
    "potential-issues": "à°¸à°‚à°­à°¾à°µà±à°¯ à°¸à°®à°¸à±à°¯à°²à±:",
  },
  mr: {
    "page-title": "à¤ªà¥€à¤• à¤¸à¤²à¥à¤²à¤¾ â€“ à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤¡à¥…à¤¶à¤¬à¥‹à¤°à¥à¤¡",
    language: "à¤­à¤¾à¤·à¤¾",
    "weather-info": "à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤®à¤¾à¤¹à¤¿à¤¤à¥€",
    "enter-city": "à¤¶à¤¹à¤°à¤¾à¤šà¥‡ à¤¨à¤¾à¤µ à¤ªà¥à¤°à¤µà¤¿à¤·à¥à¤Ÿ à¤•à¤°à¤¾",
    search: "à¤¶à¥‹à¤§à¤¾",
    "locate-me": "à¤®à¤²à¤¾ à¤¶à¥‹à¤§à¤¾",
    "loading-weather": "à¤¹à¤µà¤¾à¤®à¤¾à¤¨ à¤¡à¥‡à¤Ÿà¤¾ à¤²à¥‹à¤¡ à¤¹à¥‹à¤¤ à¤†à¤¹à¥‡...",
    temperature: "à¤¤à¤¾à¤ªà¤®à¤¾à¤¨:",
    humidity: "à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾:",
    windSpeed: "à¤µà¤¾à¤±à¥à¤¯à¤¾à¤šà¤¾ à¤µà¥‡à¤—:",
    condition: "à¤¸à¥à¤¥à¤¿à¤¤à¥€:",
    "crop-details-title": "ðŸŒ¾ à¤ªà¤¿à¤•à¤¾à¤šà¥‡ à¤¤à¤ªà¤¶à¥€à¤²",
    "crop-details-description": "à¤µà¥ˆà¤¯à¤•à¥à¤¤à¤¿à¤• à¤¸à¤²à¥à¤²à¤¾ à¤®à¤¿à¤³à¤µà¤£à¥à¤¯à¤¾à¤¸à¤¾à¤ à¥€ à¤†à¤ªà¤²à¥à¤¯à¤¾ à¤ªà¤¿à¤•à¤¾à¤¬à¤¦à¥à¤¦à¤² à¤¤à¤ªà¤¶à¥€à¤² à¤ªà¥à¤°à¤µà¤¿à¤·à¥à¤Ÿ à¤•à¤°à¤¾.",
    "crop-type-label": "à¤ªà¤¿à¤•à¤¾à¤šà¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "crop-type-placeholder": "à¤‰à¤¦à¤¾. à¤—à¤¹à¥‚, à¤¤à¤¾à¤‚à¤¦à¥‚à¤³, à¤®à¤•à¤¾",
    "growth-stage-label": "à¤µà¤¾à¤¢à¥€à¤šà¤¾ à¤Ÿà¤ªà¥à¤ªà¤¾:",
    "growth-stage-placeholder": "à¤‰à¤¦à¤¾. à¤‰à¤—à¤µà¤£, à¤«à¥à¤²à¥‹à¤°à¤¾, à¤•à¤¾à¤¢à¤£à¥€",
    "soil-type-label": "à¤®à¤¾à¤¤à¥€à¤šà¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "soil-type-placeholder": "à¤‰à¤¦à¤¾. à¤—à¤¾à¤³à¤¾à¤šà¥€, à¤šà¤¿à¤•à¤£à¤®à¤¾à¤¤à¥€, à¤µà¤¾à¤²à¥à¤•à¤¾à¤®à¤¯",
    "observations-label": "à¤…à¤²à¥€à¤•à¤¡à¥€à¤² à¤¨à¤¿à¤°à¥€à¤•à¥à¤·à¤£à¥‡:",
    "observations-placeholder": "à¤‰à¤¦à¤¾. à¤ªà¤¾à¤¨à¥‡ à¤ªà¤¿à¤µà¤³à¥€ à¤ªà¤¡à¤£à¥‡, à¤¨à¤µà¥€à¤¨ à¤•à¥‹à¤‚à¤¬, à¤•à¥€à¤Ÿà¤•à¤¾à¤‚à¤šà¥€ à¤šà¤¿à¤¨à¥à¤¹à¥‡",
    "update-crop-details": "à¤ªà¤¿à¤•à¤¾à¤šà¥‡ à¤¤à¤ªà¤¶à¥€à¤² à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤°à¤¾ à¤†à¤£à¤¿ à¤¸à¤²à¥à¤²à¤¾ à¤®à¤¿à¤³à¤µà¤¾",
    "crop-details-updated": "à¤ªà¤¿à¤•à¤¾à¤šà¥‡ à¤¤à¤ªà¤¶à¥€à¤² à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¥‡à¤²à¥‡! à¤µà¥ˆà¤¯à¤•à¥à¤¤à¤¿à¤• à¤¸à¤²à¥à¤²à¤¾ à¤®à¤¿à¤³à¤¤ à¤†à¤¹à¥‡...",
    "crop-advice": "ðŸŒ± à¤ªà¥€à¤• à¤¸à¤²à¥à¤²à¤¾",
    "pest-alerts": "ðŸ› à¤•à¥€à¤Ÿà¤• à¤¸à¥‚à¤šà¤¨à¤¾",
    "watering-suggestion": "ðŸ’§ à¤ªà¤¾à¤£à¥€ à¤¦à¥‡à¤£à¥à¤¯à¤¾à¤šà¥‡ à¤¸à¥‚à¤šà¤¨à¤¾",
    "image-analysis-title": "ðŸ“¸ à¤ªà¥€à¤• à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£",
    "image-analysis-description": "à¤à¤†à¤¯-à¤¶à¤•à¥à¤¤à¥€à¤µà¤° à¤†à¤§à¤¾à¤°à¤¿à¤¤ à¤…à¤‚à¤¤à¤°à¥à¤¦à¥ƒà¤·à¥à¤Ÿà¥€à¤¸à¤¾à¤ à¥€ à¤†à¤ªà¤²à¥à¤¯à¤¾ à¤ªà¤¿à¤•à¤¾à¤šà¥€ à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¤¾.",
    "upload-image-button": "à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤¨à¤¿à¤µà¤¡à¤¾",
    "no-file-chosen": "à¤•à¥‹à¤£à¤¤à¥€à¤¹à¥€ à¤«à¤¾à¤‡à¤² à¤¨à¤¿à¤µà¤¡à¤²à¥‡à¤²à¥€ à¤¨à¤¾à¤¹à¥€",
    "analyze-image-button": "à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤•à¤°à¤¾",
    "image-upload-success": "à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤¯à¤¶à¤¸à¥à¤µà¥€à¤°à¤¿à¤¤à¥à¤¯à¤¾ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¥‡à¤²à¥€. à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤•à¤°à¤¤ à¤†à¤¹à¥‡...",
    "image-analysis-failed": "à¤ªà¥à¤°à¤¤à¤¿à¤®à¤¾ à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤…à¤¯à¤¶à¤¸à¥à¤µà¥€ à¤à¤¾à¤²à¥‡. à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤¨à¥à¤¹à¤¾ à¤ªà¥à¤°à¤¯à¤¤à¥à¤¨ à¤•à¤°à¤¾.",
    "analysis-results-heading": "à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤ªà¤°à¤¿à¤£à¤¾à¤®:",
    "detected-crop-type": "à¤“à¤³à¤–à¤²à¥‡à¤²à¤¾ à¤ªà¤¿à¤•à¤¾à¤šà¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°:",
    "health-status": "à¤†à¤°à¥‹à¤—à¥à¤¯ à¤¸à¥à¤¥à¤¿à¤¤à¥€:",
    "potential-issues": "à¤¸à¤‚à¤­à¤¾à¤µà¥à¤¯ à¤¸à¤®à¤¸à¥à¤¯à¤¾:",
  },
}

function translatePage(lang) {
  const currentTranslations = translations[lang]
  if (!currentTranslations) {
    console.warn(`No translations found for language: ${lang}`)
    return
  }

  // Update elements with data-i18n attribute
  document.querySelectorAll("[data-i18n]").forEach((element) => {
    const key = element.getAttribute("data-i18n")
    if (currentTranslations[key]) {
      element.textContent = currentTranslations[key]
    }
  })

  // Update elements with data-i18n-placeholder attribute
  document.querySelectorAll("[data-i18n-placeholder]").forEach((element) => {
    const key = element.getAttribute("data-i18n-placeholder")
    if (currentTranslations[key]) {
      element.setAttribute("placeholder", currentTranslations[key])
    }
  })

  // Update the document title
  const titleElement = document.querySelector("title")
  if (titleElement && currentTranslations["page-title"]) {
    titleElement.textContent = currentTranslations["page-title"]
  }

  // Set the lang attribute on the html tag
  document.documentElement.lang = lang
}

// Global variable to store current crop details
const currentCropDetails = {
  cropType: "wheat",
  growthStage: "flowering",
  soilType: "loamy",
  observations: "healthy growth",
  imageAnalysis: {}, // New field for image analysis results
}

let selectedImageFile = null // To store the selected file for upload

document.addEventListener("DOMContentLoaded", () => {
  // Initial translation based on the default selected option
  const initialLang = document.getElementById("langSelect").value
  translatePage(initialLang)

  // Populate crop details inputs with initial values
  document.getElementById("cropTypeInput").value = currentCropDetails.cropType
  document.getElementById("growthStageInput").value = currentCropDetails.growthStage
  document.getElementById("soilTypeInput").value = currentCropDetails.soilType
  document.getElementById("observationsInput").value = currentCropDetails.observations

  fetchWeatherByGeolocation()
  fetchPersonalizedAdvice() // Call personalized advice on load

  document.getElementById("langSelect").addEventListener("change", function () {
    translatePage(this.value)
  })

  document.getElementById("searchButton").addEventListener("click", () => {
    const city = document.getElementById("cityInput").value
    if (city) {
      fetchWeatherByCity(city)
    } else {
      displayError("Please enter a city name.")
    }
  })

  document.getElementById("locateMeButton").addEventListener("click", fetchWeatherByGeolocation)
  document.getElementById("updateCropDetailsButton").addEventListener("click", updateCropDetails)

  // Image Upload Event Listeners
  document.getElementById("uploadImageButton").addEventListener("click", () => {
    document.getElementById("cropImageInput").click()
  })

  document.getElementById("cropImageInput").addEventListener("change", (event) => {
    const file = event.target.files[0]
    if (file) {
      selectedImageFile = file
      document.getElementById("fileNameDisplay").textContent = file.name
      const reader = new FileReader()
      reader.onload = (e) => {
        const preview = document.getElementById("uploadedImagePreview")
        preview.src = e.target.result
        preview.style.display = "block"
      }
      reader.readAsDataURL(file)
    } else {
      selectedImageFile = null
      document.getElementById("fileNameDisplay").textContent =
        translations[document.documentElement.lang]["no-file-chosen"]
      document.getElementById("uploadedImagePreview").style.display = "none"
    }
  })

  document.getElementById("analyzeImageButton").addEventListener("click", fetchCropImageAnalysis)
})

async function fetchWeatherByGeolocation() {
  displayLoading(true)
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      async (position) => {
        const lat = position.coords.latitude
        const lon = position.coords.longitude
        await fetchWeather(`/api/weather?lat=${lat}&lon=${lon}`)
      },
      () => {
        displayError("Unable to retrieve location.")
        fetchWeatherByCity("Motihari")
      },
    )
  } else {
    displayError("Geolocation not supported.")
    fetchWeatherByCity("Motihari")
  }
}

async function fetchWeatherByCity(city) {
  displayLoading(true)
  await fetchWeather(`/api/weather?city=${encodeURIComponent(city)}`)
}

async function fetchWeather(url) {
  try {
    const res = await fetch(url)
    if (!res.ok) throw new Error((await res.json()).error)
    const data = await res.json()

    document.getElementById("temperature").textContent = `${data.temperature} Â°C`
    document.getElementById("humidity").textContent = `${data.humidity} %`
    document.getElementById("windSpeed").textContent = `${data.windSpeed} km/h`
    document.getElementById("condition").textContent = data.condition
    document.querySelector(".weather-icon").textContent = mapIconToEmoji(data.icon)
    document.getElementById("locationDisplay").textContent = data.city
  } catch (err) {
    displayError(err.message)
  } finally {
    displayLoading(false)
  }
}

function displayLoading(show) {
  document.getElementById("loadingMessage").style.display = show ? "block" : "none"
}

function displayError(message) {
  const error = document.getElementById("errorMessage")
  error.textContent = message
  error.style.display = message ? "block" : "none"
  document.getElementById("cropDetailsMessage").style.display = "none" // Hide info message if error
  document.getElementById("imageAnalysisMessage").style.display = "none" // Hide image info message if error
}

function displayInfo(message, targetElementId = "cropDetailsMessage") {
  const info = document.getElementById(targetElementId)
  info.textContent = message
  info.style.display = message ? "block" : "none"
  document.getElementById("errorMessage").style.display = "none" // Hide error message if info
}

function mapIconToEmoji(icon) {
  const icons = {
    "01d": "â˜€ï¸",
    "01n": "ðŸŒ™",
    "02d": "â›…",
    "03d": "â˜ï¸",
    "09d": "ðŸŒ§ï¸",
    "10d": "ðŸŒ¦ï¸",
    "11d": "â›ˆï¸",
    "13d": "â„ï¸",
    "50d": "ðŸŒ«ï¸",
  }
  return icons[icon] || "â“"
}

async function updateCropDetails() {
  currentCropDetails.cropType = document.getElementById("cropTypeInput").value || "wheat"
  currentCropDetails.growthStage = document.getElementById("growthStageInput").value || "flowering"
  currentCropDetails.soilType = document.getElementById("soilTypeInput").value || "loamy"
  currentCropDetails.observations = document.getElementById("observationsInput").value || "healthy growth"

  displayInfo(translations[document.documentElement.lang]["crop-details-updated"])
  await fetchPersonalizedAdvice()
  setTimeout(() => displayInfo("", "cropDetailsMessage"), 3000) // Hide message after 3 seconds
}

async function fetchPersonalizedAdvice() {
  const params = new URLSearchParams(currentCropDetails).toString()
  try {
    const [adviceRes, pestsRes, wateringRes] = await Promise.all([
      fetch(`/api/advice?${params}`),
      fetch(`/api/pests?${params}`),
      fetch(`/api/watering?${params}`),
    ])

    const adviceData = await adviceRes.json()
    const pestsData = await pestsRes.json()
    const wateringData = await wateringRes.json()

    document.getElementById("adviceText").textContent = adviceData.advice

    const pestList = document.getElementById("pestAlerts")
    pestList.innerHTML = ""
    pestsData.alerts.forEach((a) => {
      const li = document.createElement("li")
      li.textContent = a
      pestList.appendChild(li)
    })

    document.getElementById("wateringText").textContent = wateringData.watering
  } catch (error) {
    displayError("Failed to fetch personalized advice: " + error.message)
  }
}

async function fetchCropImageAnalysis() {
  if (!selectedImageFile) {
    displayError("Please select an image to analyze.", "imageAnalysisMessage")
    return
  }

  displayInfo(translations[document.documentElement.lang]["image-upload-success"], "imageAnalysisMessage")
  document.getElementById("imageAnalysisResults").style.display = "none" // Hide previous results

  const formData = new FormData()
  formData.append("crop_image", selectedImageFile)

  try {
    const res = await fetch("/api/analyze-crop-image", {
      method: "POST",
      body: formData,
    })

    if (!res.ok) throw new Error((await res.json()).error || "Unknown error during analysis.")

    const data = await res.json()
    currentCropDetails.imageAnalysis = data // Store analysis results

    // Update crop details inputs based on image analysis
    if (data.detectedCropType) {
      document.getElementById("cropTypeInput").value = data.detectedCropType
      currentCropDetails.cropType = data.detectedCropType
    }
    if (data.healthStatus || data.potentialIssues) {
      const newObservations = []
      if (data.healthStatus && data.healthStatus !== "Healthy") {
        newObservations.push(`Health: ${data.healthStatus}`)
      }
      if (data.potentialIssues && data.potentialIssues.length > 0) {
        newObservations.push(`Issues: ${data.potentialIssues.join(", ")}`)
      }
      if (newObservations.length > 0) {
        document.getElementById("observationsInput").value = newObservations.join(". ")
        currentCropDetails.observations = newObservations.join(". ")
      }
    }

    // Display analysis results
    document.getElementById("detectedCropType").textContent = data.detectedCropType || "N/A"
    document.getElementById("healthStatus").textContent = data.healthStatus || "N/A"
    document.getElementById("potentialIssues").textContent = data.potentialIssues.join(", ") || "None"
    document.getElementById("imageAnalysisResults").style.display = "block"

    displayInfo("", "imageAnalysisMessage") // Clear info message
    await fetchPersonalizedAdvice() // Re-fetch advice with updated details
  } catch (err) {
    displayError(
      translations[document.documentElement.lang]["image-analysis-failed"] + " " + err.message,
      "imageAnalysisMessage",
    )
  }
}
